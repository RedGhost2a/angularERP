<div class="global-height">
  <div class="big-container global-big-container">
    <h3 class="title global-title"> Liste des devis</h3>
    <div class="header global-header">
      <mat-form-field class="global-search-input">
        <mat-label>Recherche d'un devis</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. cim..." #input>
      </mat-form-field>
      <div class="global-button-add custom-button-add">
        <button (click)="openDialogCreateClient(null, false)" mat-stroked-button color="primary">Creer un client</button>
        <button (click)="openDialogCreate()" mat-raised-button color="primary">Creer un devis</button>
      </div>
    </div>
    <div class="container global-container">
      <table mat-table [dataSource]="dataSource"
             class="mat-elevation-z8 global-table">
        <ng-container matColumnDef="nDevis">
          <th class="global-th" mat-header-cell *matHeaderCellDef>N° du devis</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.id}}</td>
        </ng-container>
        <ng-container matColumnDef="client">
          <th class="global-th" mat-header-cell *matHeaderCellDef> Client</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.Client.denomination}} </td>
        </ng-container>
        <ng-container matColumnDef="nomDevis">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Nom du devis</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.name}}</td>
        </ng-container>
        <ng-container matColumnDef="dateDevis">
          <th class="global-th" mat-header-cell *matHeaderCellDef> Date du devis</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.createdAt | date:'dd/MM/YYYY'}}</td>
        </ng-container>
        <ng-container matColumnDef="status">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Status</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.status}}</td>
        </ng-container>
        <ng-container matColumnDef="referent">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Referent</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.Users[0].firstName}}
            {{devis.Users[0].lastName}}</td>
        </ng-container>
        <ng-container matColumnDef="prixVenteHT">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Montant HT</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.prixVenteHT | number: '1.2-2'}} €
          </td>
        </ng-container>
        <ng-container matColumnDef="benefice">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Benefice</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.beneficeInPercent | number: '1.2-2'}} %
          </td>
        </ng-container>
        <ng-container matColumnDef="aleas">
          <th class="global-th" mat-header-cell *matHeaderCellDef>Aléas</th>
          <td class="global-td" routerLink="/devisDetail/{{devis.id}}" mat-cell
              *matCellDef="let devis">{{devis.aleasInPercent | number: '1.2-2'}} %
          </td>
        </ng-container>
        <ng-container matColumnDef="boutons">
          <th class="global-th" mat-header-cell *matHeaderCellDef></th>
          <td class="global-td" mat-cell *matCellDef="let cout">
            <mat-icon [matMenuTriggerFor]="boutonCout">more_vert</mat-icon>
            <mat-menu class="menuBoutonCout" #boutonCout>
              <button (click)="deleteItem(cout.id)" mat-button color="warn">
                <mat-icon>clear</mat-icon>
                Supprimer
              </button>
            </mat-menu>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row class="global-td-hover"
            (click)="clickedRows.add(row)"
            [class.demo-row-is-clicked]="clickedRows.has(row)"
            *matRowDef="let row; columns: displayedColumns;">
        </tr>
      </table>
    </div>
  </div>
</div>
